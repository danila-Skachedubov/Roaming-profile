# Что надо делать на контроллере

Все действия ниже выполняются в ADMC (для корректной работы необходимо получить
kerberos ticket. Выполните команду (от обычного пользователя) 
kinit administrator и введите пароль администратора домена)
- Добавить всех пользователей с паролями в домен (в admc рaзdернуть дерево с
  domain.alt  и в папке users через пкм создать пользователя, в открывшемся
  окне  заполнить поля имя, имя для входа, пароли и убрать галочку пользователь
  должен сменить пароль, и поставить галочку пароль не истекает)
- Добавить этих пользователей в группу domain admins и добавить всех в одно
  подразделение (в admc из папки users перетащить пользователей в подразделение
  camp2024 в том же дереве, далее в папке users открыть группу domain admins и
  в списке участников добавить всех пользователей в эту группу)
- Если у ноутбука поменялся hostname, нужно добавить его в подразделение заново

# Что надо делать на каждой машине

- Переустанавливаем систему на свежую Альт Образование (10.3)
- ВАЖНО!!! При установке нужно установить hostname, который потом будет
  использован при вводе в домен(например LAPTOP-99) 
- ВАЖНО!!! При установке обязательно выбираем правильный часовой пояс (Саратов GMT+4)
- При установке выбираем галочками
  - 1 пункт (что-то про базовые инструменты)
  - 2 пункт - Офисный пакет
  - Выбрать пункт с KDE
- Поставить нормальные пароли для root и созданного пользователя (например,
  пользователь admin)
- Зайти в пользователя admin и подключиться к Wi-Fi Camp2024:Camp2024
- Зайти в параметры соединения Camp2024
  - Во вкладке "Основные параметры" включить опцию "Все пользователи могут подключаться к этой сети"
  - Проверить, что во вкладке "Защита Wi-Fi" указан пароль и указана опция
    "Сохранить пароль для всех пользователей (незашифрованный)".
- Удалить пакет adp
  - Командой su - заходим в суперпользователя
  - Удаляем apt-get remove -y adp
- Заходим в acc (Альтератор).
  - Открываем "Пользователи > Аутентификация"
  - Выбираем пункт "Домен Active Directory"
  - В рабочей группе вводим DOMAIN
  - В домене должен уже быть указан DOMAIN.ALT
  - Имя компьютера уже должно быть указано
  - Поставить галочку на "Восстановить файлы конфигурации по умолчанию ..." снизу страницы
  - Нажимаем применить, нажать да
  - Галка "Включить групповые политики" должна быть включена
  - Вводим пароль доменного администратора и нажимаем ОК (Pa$$word)
  - Машина должна быть успешно введена в домен
- Перезагружаемся
- ВАЖНО!!! Нужна дополнительная конфигурация на КД без этой настройки можно
  заходить в пользователя, но не будут применяться политики
  - Все действия ниже выполняются в ADMC (для корректной работы необходимо
    получить kerberos ticket. Выполните команду (от обычного пользователя) kinit
    administrator и введите пароль администратора домена)
  - Добавить хост нового компьютера в домен (ноутбуки для этого нужно
    рaзвернуть дерево с domain.alt и открыть папку computers, там есть машины
    введенные ранее в домен, их нужно перенести в подразделение camp2024)
- Машина должна подключиться в Wi-Fi самостоятельно уже на экране логина
- Можно входить в доменного пользователя
  - Рядом со значком сети есть кнопка для входа под другим пользователем (I>)
- Внимательно смотрим на чёрный экран (применяются политики и синхронизируется)

# Дополнительные вещи

- Контроллер домена 192.168.1.5 (dc.domain.alt)
- Домен DOMAIN.ALT, рабочая группа DOMAIN
- Модем 192.168.1.42, пароль Jcyjdyjq_ik.p
- ВАЖНО!!! Если обновлять систему через dist-upgrade, нужно перейти в tty
  (Ctrl+Alt+F2,F3,...), чтобы при обновлении графического окружения ничего не
  сломалось.
- (ОПЦИОНАЛЬНО) На КД в домашней директории пользователя user:user лежит скрипт
  startup.sh. Он устанавливает разные IDE, компиляторы и всё остальное. Его
  можно скачать `scp user@dc.domain.alt:startup.sh .` Обновляться скорее всего
  будет долго.
- Если в какой-то момент перестала работать сеть, необходимо проверить dhcpd и
  samba на контроллере домена.  Проверка осуществляется командой (от
  суперпользователя) systemctl status dhcpd.service и systemctl status samba
  Если сломалось, сделайте systemctl restart dhcpd.service и
  systemctl restart samba
